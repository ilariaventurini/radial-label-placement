{"version":3,"sources":["../index.ts","../../node_modules/element-size/index.js","../../node_modules/canvas-fit-margin-ts/dist/index.js","utils.ts","demo.ts"],"names":[],"mappings":"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","file":"demo.f41ad5e9.map","sourceRoot":"../src/demo","sourcesContent":["/*\n\nQuadrant:\n\n\n               ````````````````````               \n            ```         ``         ```            \n         ``             ``             ``         \n       ``               ``               ``       \n     ``                 ``                 ``     \n    `                   ``                   `    \n  ``         2          ``          3         ``  \n ``                     ``                     `` \n `                      ``                      ` \n`                       ``                       `\n`                       ``                       `\n`                       ``                       `\n.```````````````````````..```````````````````````.\n`                       ``                       `\n`                       ``                       `\n`                       ``                       `\n `         1            ``        0             ` \n ``                     ``                     `` \n  ``                    ``                    ``  \n    `                   ``                   `    \n     ``                 ``                 ``     \n       ``               ``               ``       \n         ``             ``             ``         \n            ```         ``         ```            \n               ````````````````````               \n\n\nEdges:\n\n\n                                3\n\n                        ````-mNMMMMNm- ```                \n                    ```      NMMMMMMN      ```            \n                 ``          sMMMMMMs          ``         \n               ``            -MMMMMM-            ``       \n             ``               mMMMMm               ``     \n            `                 oMMMMo                 `    \n          ``                  .MMMM.                  `   \n          `                    mMMd                    `  \n         `                     oMMo                     ` \n        `                      .MM.                      `\n        oso+/-.`                dd                `.-/+oso\n        NMMMMMMMMNdhys+/:-`     ++     `-:/+syhdNMMMMMMMMN\n2      MMMMMMMMMMMMMMMMMMMMmyo/::/oymMMMMMMMMMMMMMMMMMMMM     0\n        NMMMMMMMMNdhys+/:-`     ++     `-:/+syhdNMMMMMMMMN\n        oso+/-.`                dd                `.-/+oso\n        `                      .MM.                      `\n         `                     oMMo                     ` \n          `                    mMMd                    `  \n           `                  .MMMM.                  `   \n            `                 oMMMMo                 `    \n             ``               mMMMMm               ``     \n               ``            -MMMMMM-            ``       \n                 ``          sMMMMMMs          ``         \n                    ```      NMMMMMMN      ```            \n                        ` ``-mNMMMMNm- ` `                \n\n                                1\n\n*/\n\nconst isInRange = (x: number, minMax: number[]): boolean => x >= minMax[0] && x <= minMax[1]\n\nexport const radialLabelPlacement = (angleRadians: number) => {\n  const angle = ((180 * angleRadians) / Math.PI) % 360\n\n  let textAlign: 'center' | 'end' | 'start' = 'center'\n  let textBaseline: 'top' | 'middle' | 'bottom' = 'middle'\n\n  let quadrant = 0\n\n  if (isInRange(angle, [0, 90])) {\n    quadrant = 0\n  } else if (isInRange(angle, [90, 180])) {\n    quadrant = 1\n  } else if (isInRange(angle, [180, 270])) {\n    quadrant = 2\n  } else if (isInRange(angle, [270, 360])) {\n    quadrant = 3\n  }\n\n  if (quadrant === 0) {\n    textAlign = 'start'\n    textBaseline = 'top'\n  } else if (quadrant === 1) {\n    textAlign = 'end'\n    textBaseline = 'top'\n  } else if (quadrant === 2) {\n    textAlign = 'end'\n    textBaseline = 'bottom'\n  } else if (quadrant === 3) {\n    textAlign = 'start'\n    textBaseline = 'bottom'\n  }\n\n  let edge = null\n\n  if (isInRange(angle, [0, 10]) || isInRange(angle, [350, 0])) {\n    edge = 0\n  } else if (isInRange(angle, [80, 100])) {\n    edge = 1\n  } else if (isInRange(angle, [170, 190])) {\n    edge = 2\n  } else if (isInRange(angle, [260, 280])) {\n    edge = 3\n  }\n\n  if (edge === 0) {\n    textBaseline = 'middle'\n  } else if (edge === 1) {\n    textAlign = 'center'\n  } else if (edge === 2) {\n    textBaseline = 'middle'\n  } else if (edge === 3) {\n    textAlign = 'center'\n  }\n\n  return { textAlign, textBaseline }\n}\n","module.exports = getSize\n\nfunction getSize(element) {\n  // Handle cases where the element is not already\n  // attached to the DOM by briefly appending it\n  // to document.body, and removing it again later.\n  if (element === window || element === document.body) {\n    return [window.innerWidth, window.innerHeight]\n  }\n\n  if (!element.parentNode) {\n    var temporary = true\n    document.body.appendChild(element)\n  }\n\n  var bounds = element.getBoundingClientRect()\n  var styles = getComputedStyle(element)\n  var height = (bounds.height|0)\n    + parse(styles.getPropertyValue('margin-top'))\n    + parse(styles.getPropertyValue('margin-bottom'))\n  var width  = (bounds.width|0)\n    + parse(styles.getPropertyValue('margin-left'))\n    + parse(styles.getPropertyValue('margin-right'))\n\n  if (temporary) {\n    document.body.removeChild(element)\n  }\n\n  return [width, height]\n}\n\nfunction parse(prop) {\n  return parseFloat(prop) || 0\n}\n","\"use strict\";var __assign=this&&this.__assign||function(){return(__assign=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};exports.__esModule=!0;var getSize=require(\"element-size\"),defaultOptions={parent:null,margin:0,scale:1};function createFit(r,e){var t=__assign({},defaultOptions,e),s=t.margin,a=t.scale,o=t.parent;function i(){var e,t,i=o||r.parentNode;if(i&&i!==document.body){var n=getSize(i);e=0|n[0],t=0|n[1]}else e=window.innerWidth,t=window.innerHeight;return e-=2*s,t-=2*s,r.width=e*a,r.height=t*a,r.style.width=e+\"px\",r.style.height=t+\"px\",[e,t]}return r.style.position=r.style.position||\"relative\",r.style.top=\"0\",r.style.left=\"0\",r.style.margin=s+\"px\",i(),i}exports.createFit=createFit;","import { Vec2, Align, Baseline } from './types'\n\nexport function pointOnCircle(angle: number, radius: number, center: Vec2): Vec2 {\n  return [Math.cos(angle) * radius + center[0], Math.sin(angle) * radius + center[1]]\n}\n\nexport function getTickData(\n  ticks: { angle: number; label: string; labelOffset: Vec2 }[],\n  radius: number,\n  center: Vec2,\n) {\n  return ticks.map(tick => {\n    const angle = tick.angle * Math.PI\n    const p1: Vec2 = pointOnCircle(angle, radius, center)\n    const p2: Vec2 = pointOnCircle(angle, radius - 25, center)\n    const p3: Vec2 = pointOnCircle(angle, radius + 15, center)\n    return { ...tick, angle, p1, p2, p3 }\n  })\n}\n\nexport function strokeBoundingBox(\n  context: CanvasRenderingContext2D,\n  point: Vec2,\n  width: number,\n  height: number,\n  textAlign: Align,\n  textBaseline: Baseline,\n) {\n  context.strokeRect(\n    point[0] + offsetX[textAlign](width),\n    point[1] + offsetY[textBaseline](height),\n    width,\n    height,\n  )\n}\n\nexport const offsetX = {\n  start: (w: number) => 0,\n  center: (w: number) => -w / 2,\n  end: (w: number) => -w,\n}\n\nexport const offsetY = {\n  top: (h: number) => 0,\n  middle: (h: number) => -h / 2,\n  bottom: (h: number) => -h,\n}\n","import { radialLabelPlacement } from '..'\nimport { createFit } from 'canvas-fit-margin-ts'\nimport { Vec2 } from './types'\nimport { getTickData, strokeBoundingBox } from './utils'\n\nconst scale = window.devicePixelRatio || 1\nconst canvas = document.createElement('canvas')\nconst context = canvas.getContext('2d')\nconst fit = createFit(canvas, { scale })\ndocument.body.style.margin = '0'\ndocument.body.appendChild(canvas)\n\nconst ticks: { angle: number; label: string; labelOffset: Vec2 }[] = [\n  { angle: 0, label: `0`, labelOffset: [0, 15] },\n  { angle: 1 / 4, label: `π / 4`, labelOffset: [0, 35] },\n  { angle: 1 / 2, label: `π / 2`, labelOffset: [0, 35] },\n  { angle: 3 / 4, label: `3/4 π`, labelOffset: [0, 35] },\n  { angle: 1, label: `π`, labelOffset: [0, 25] },\n  { angle: 5 / 4, label: `5/4 π`, labelOffset: [-10, 0] },\n  { angle: 3 / 2, label: `3/2 π`, labelOffset: [0, -95] },\n  { angle: 7 / 4, label: `7/4 π`, labelOffset: [0, 0] },\n]\n\nfunction render(width: number, height: number) {\n  const radius = Math.min(width, height) * 0.6\n  const center: Vec2 = [canvas.width / 2, canvas.height / 2]\n\n  context.fillStyle = 'black'\n  context.strokeStyle = 'black'\n\n  context.arc(center[0], center[1], radius, 0, Math.PI * 2)\n  context.stroke()\n\n  context.save()\n  context.translate(...center)\n\n  context.beginPath()\n  context.moveTo(-10, 0)\n  context.lineTo(10, 0)\n  context.stroke()\n\n  context.moveTo(0, -10)\n  context.lineTo(0, 10)\n  context.stroke()\n  context.restore()\n\n  getTickData(ticks, radius, center).forEach(tick => {\n    context.fillStyle = 'black'\n    context.strokeStyle = 'black'\n\n    context.beginPath()\n    context.moveTo(...tick.p1)\n    context.lineTo(...tick.p2)\n    context.stroke()\n\n    const { textAlign, textBaseline } = radialLabelPlacement(tick.angle)\n\n    context.font = '48px monospace'\n    context.textAlign = textAlign\n    context.textBaseline = textBaseline\n    context.fillText(tick.label, ...tick.p3)\n\n    context.fillStyle = '#bbb'\n    context.strokeStyle = '#bbb'\n\n    const box = context.measureText(tick.label)\n    strokeBoundingBox(context, tick.p3, box.width, 48, textAlign, textBaseline)\n\n    context.moveTo(...tick.p3)\n    context.arc(tick.p3[0], tick.p3[1], 4, 0, Math.PI * 2)\n    context.fill()\n\n    context.font = '18px monospace'\n    context.fillText(\n      `textAlign: ${textAlign}`,\n      tick.p3[0] + tick.labelOffset[0],\n      tick.p3[1] + 22 + tick.labelOffset[1],\n    )\n    context.fillText(\n      `textBaseline: ${textBaseline}`,\n      tick.p3[0] + tick.labelOffset[0],\n      tick.p3[1] + 44 + tick.labelOffset[1],\n    )\n  })\n}\n\nconst onResize = () => {\n  const [width, height] = fit()\n  render(width, height)\n}\n\nwindow.addEventListener('resize', onResize)\ndocument.onreadystatechange = function() {\n  onResize()\n}\nonResize()\n\nif (module.hot) {\n  module.hot.dispose(() => canvas.remove())\n}\n"]}